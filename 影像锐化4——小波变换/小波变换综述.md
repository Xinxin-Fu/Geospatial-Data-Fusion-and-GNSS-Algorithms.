# 小波变换在数据融合中的应用

## 1. 基本思想

小波变换能够将影像分解成不同尺度的低频（近似）和高频（细节）分量。在影像融合中，核心思想是：

1. 对多光谱影像和高分辨率全色影像（PAN）进行小波分解，得到各自的低频和高频分量；
2. 将多光谱影像的低频分量与高分辨率全色影像的高频分量进行融合，以保留多光谱的光谱信息，同时增强空间细节；
3. 对融合后的分量进行小波逆变换，得到高分辨率融合影像。

---

## 2. 基本步骤（文字描述）

1. **小波分解**  
   对每个波段（多光谱和 PAN）进行二维小波分解，得到低频近似和高频细节（水平、垂直、对角）系数。

2. **融合策略**  
   - 低频部分通常保留多光谱波段原始信息（光谱特征）；  
   - 高频部分引入高分辨率全色影像的细节信息（增强空间分辨率）；  
   - 高频融合可以采用简单加权、最大值选择或其他规则。

3. **小波重构**  
   将融合后的低频和高频系数进行小波逆变换，得到融合后的高分辨率多光谱影像。

4. **后处理**  
   可进行线性拉伸或归一化，保证融合影像的像元值与原始波段一致。

---

## 3. Python 简单示例（模拟 3×3 矩阵）

```python
import pywt
import numpy as np

# 模拟多光谱R波段
R = np.array([[50, 80, 60],
              [70, 60, 90],
              [30, 50, 40]], dtype=float)

# 模拟高分辨率PAN
PAN = np.array([[200, 220, 210],
                [180, 200, 190],
                [150, 170, 160]], dtype=float)

# Step 1: 小波分解
coeffs_R = pywt.dwt2(R, 'haar')  # (cA, (cH, cV, cD))
cA_R, (cH_R, cV_R, cD_R) = coeffs_R

coeffs_PAN = pywt.dwt2(PAN, 'haar')
cA_PAN, (cH_PAN, cV_PAN, cD_PAN) = coeffs_PAN

# Step 2: 融合高频
cH_fused = cH_PAN
cV_fused = cV_PAN
cD_fused = cD_PAN

# Step 3: 小波逆变换
R_fused = pywt.idwt2((cA_R, (cH_fused, cV_fused, cD_fused)), 'haar')

print("融合后的R波段:\n", R_fused)
